# karpov_courses

---
## final_project (анализ A/B-теста, SQL, автообновление данных A/B-теста)
## Задача 1. A/B–тестирование
### Цель проекта:  
- проанализировать результаты A/B-теста новой механики оплаты;
- выбрать метрики;
- объяснить имеющиеся различия в значениях метрик разных групп;
- для групп разного размера определить являются ли различия статистически значимыми;
- сделать выводы о целесообразности запуска новой механики на всех пользователей.

### В мои задачи входило: 
- объединение 4-х файлов csv;
- выбор "рабочей" аудитории в группах из общей массы пользователей;
- выбор метрик;
- реализация функции проверки гипотез методом bootstrap.

### Результат:  
- в период проведения экспериментов были выявлены оплаты от неактивных пльзователей, их было решено не брать их в расчёт;
- для оценки метрик в группах размер которых отличался в 4 раза принято решение использовать метод bootstrap;
- расчитаны CR в покупку (эффект отрицательный), ARPU и ARPPU (эффект положительный);
- различия в ARPU и ARPPU приняты статистически значимыми, различия в CR - статистически не значимыми;
- сделан вывод: новая механика оплаты даёт статистически значимый прирост в метриках ARPU и ARPPU, отрицательное изменение метрики CR не подтвердилось.

### В работе использовались:   
- библиотеки requests и urllib.parse для получения прямой ссылки и загрузки файлов с Яндекс.Диска;
- библиотеки tqdm.auto для визуализации индикатора програсса;
- библиотеки pandas, seaborn, scipy.stats, matplotlib.pyplot для обработки и визуализации данных.

## Задача 2. SQL
### Цель проекта:  
- написать оптимальный запрос, который даст информацию о количестве очень усердных студентов за март 2020 года;
- в одном запросе выгрузить: ARPU, ARPAU, CR в покупку, СR активного пользователя в покупку, CR пользователя из активности по математике в покупку курса по математике;

### В мои задачи входило: 
- объединение таблиц различными видами джойнов;
- расчёт метрик.

### Результат:  
- запросы написаны и проверены в СУБД Postgresql;

### В работе использовались:  
- подзапросы;
- оконные функции.

## Задача 3. Python
### Цель проекта:  
- написать функцию для обновления данных и пересчёта метрик;
- написать функцию для визуализации пересчитываемых метрик.

### В мои задачи входило: 
- разработка логики работы функций;
- написание целевых и вспомогательных функций на Python.

### Результат:  
- функция обновления данных скачивает дополнительный файл по веб-ссылке, или использует файл, расположенный локально, дополняет данные, выдаёт датафрэйм с метриками, рассчитанными на каждом этапе обновления;
- функция визуализации метрик берёт на вход датафрэйм, полученный функцией обновления и строит 6 графиков: 3 метрики и 3 p-value этих метрик для каждого шага обновления, показывая динамику.

### В работе использовались:   
- библиотека re для автоматического определения разделителя CSV-файла;
- функция bootstrap с первого задания;
- библиотеки pandas, seaborn, matplotlib.pyplot для обработки и визуализации данных.

---

## 1st_project (e-commerce_project, анализ покупок)
### Цель проекта:  
- выбрать критерии, определяющие что считать покупкой и какой товар считать недоставленным;  
- определить количество пользователей, сделавших только одну покупку;  
- определить в какие дни недели чаще всего покупаюется каждый из товаров;  
- сколько у каждого пользователя в среднем покупок за неделю (по месяцам);  
- выявить когорту с самым высоким retention на 3-й месяц;   
- построить RFM-кластеры для пользователей и вывести для каждого кластера средние значения метрик R, F, M  

### В мои задачи входило:   
- объединение 3-х датасетов;   
- анализ данных для определения критериев;  
- расчёт необходимых показателей;  
- написание функций на Python;     
- проведение RFM-анализа.  

### Результат:  
- критерием покупки служит любой статус, за исключеием: `created`, `unavailable`, `canceled`;  
- всё, что имеет статус отличный от `delivered` решено считать недоставленным;  
- найдено количество пользователей, сделавшими только одну покупку;  
- найдено количество не доставленных заказов ко каждому статусу;  
- найден датасет с уникальными пользователями и днями недели, в которые покупки совершаются чаще всего; если таких дней несколько - указаны все;  
- реализована функция на Python для проведения когортного анализа с возможностью указывать расчётный период;  
- выявлена когорта с самым высоким retention на 3-й месяц;  
- RFM-анализ выполнен тримя способами (визуально-аналитический, k-means, скрипт от сотрудника Google Александра Приходько); результаты всех трёх подходов очень близки, что говорит о низкой вероятности ошибки в расчётах.      

### В работе использовались:   
- визуально-аналитический метод сегментации по графикам;  
- работа со скриптом на удалённом сервере;  
- метод k-means для сегментации клиентов;   
- метод "Локтя" для определения оптимального количества сегментов.   

---

## SQL  
### Цель проекта:   
- Выгрузить нужные данные из ClickHouse и проанализировать их в python.  

### В мои задачи входило:   
- написание скрипта на Python с запросами для ClickHouse.  

### Результат:  
- все запросы отработаны корректно, необходимые данные загружены и обработаны в Pandas.  

### В работе использовались:   
- библиотека `pandahouse` для использования синтаксиса SQL в запросах в jupyter notebook.  

---

## airflow  
## airflow_dag_1.0.py
### Цель проекта:     
- автоматизировать запуск задач для:
    * нахождения топ-10 доменных зон по численности доменов;  
    * нахождения домена с самым длинным именем;  
    * определения места по популярности домена airflow.com;  

### Результат:  
- написан скрипт на `Python` для `Airflow v1.0` для выполнения поставленных задач;  
- все таски отрабатываются корректно;  
- результаты выводятся в лог.  

### В работе использовались:   
- Python; 
- Airflow. 

## airflow_dag_2.0.py

### Цель проекта:  
- автоматизировать запуск задач для:
    * нахождения самой продаваемой в определённом году во всем мире;  
    * нахождения самого продаваемого жанра в Европе в указанном году;  
    * определения платформы с наибольшим количеством игр, продававшихся более чем миллионным тиражём в северной Америк;  
    * определения издателя с самым высокими средними продажами в Японии в указанных год;  
    * нахождения количества игр, продавшихся лучше в Европе, чем в Японии.  

### Результат:  
- все таски отрабатываются корректно;  
- результаты выводятся в лог.  

### В работе использовались:   
- декораторы функций;  
- Task flow API  

---

## statistics_miniprojects  

## AA-test.ipynb  
Цель проекта:  
- Проверить утверждение о поломке сплит-системы с помощью A/A-теста мобильного приложения и найти ее причины.  

### Результат:  
- проведён А/А-тест;  
- найдена причина неправильной работы сплит системы: неверное деление на группы пользователей приложения версии v2.8.0.  

### В работе использовалась:   
- метрика качества FPR  

## AB-test_churn.ipynb  
### Цель проекта:  
- изучить отток водителей и посмотреть, какие есть различия между водителями, которые покидают сервис, и которые остаются.   

### Результат:  
- проведён А/B-тест;  
- выделины группы водителей, которые наиболее подвержены "оттоку": ушедшие пользователи были менее активны.

### В работе использовалась:  
- критерий хи-квадрат;  
- Шапиро-тест на нормальность распределения;
- критерий Краскела-Уоллиса.  

## AB_test.ipynb  
### Цель проекта:  
- проверить эффективрость нового алгоритма работы приложения для курьеров.  
### Результат:  
- определено, что среднее время доставки в тесте меньше, чем в контроле, принято решение использовать новый алгоритм на всех пользователей.  
### В работе использовалась:  
- тест проверки на нормальность распределения Шапиро-Уилка;  
- тест Стьюдента.    


## anova.ipynb  
### Цель проекта:  
- оценить результаты теста разрешений фотографий блюд в приложении;  
- оценить результаты теста изменения дизайна кнопки заказа в приложении.
### Результат:  
- выбран квадратный формат картинок, как наилучший;  
- выбран новый дизайн кнопки заказа приложений.  
### В работе использовалась:  
- статистический тест ANOVA;  
- тест гомогенности Левена;  
- тест Шапиро-Уилка, normaltest, и qq-графики для оценки нормальности рпспределений;  
- критерий Тьюки для выявления статистически значимых различий.  

## bootstrap_u-test.ipynb  
### Цель проекта:  
- сравните результат между тестом и контролем по двум кейсам: бутстрапом и u-тестом.  
### Результат:  
- сделаны выводы:
    - бутстрап с функцией np.mean чувствителен к выбросам в данных;  
    - бутстрап с функцией np.median и критерий Манна-Уитни не чувствительны к выбросам в данных;   
    - татистически значимых различий между тестовой и контрольной групп нет.  
### В работе использовалась:  
- бутстрап (с np.mean);  
- бутстрап (с np.median);  
- критерий mann-whitney.   


## conversion.ipynb  
### Цель проекта: 
- проанализировать CTR с разбивкой по рекламной кампании;  
- посчитайть стоимость за клик пользователя по объявлению (CPC);  
- визуализировать CPC с разбивкой по полу пользователей;  
- посчитать конверсию из клика в покупку.  
### Результат:  
- визуализирован CTR с разбивкой по номеру рекламной кампании;
- в исходный датафрейм добавлена колонка с CPC;  
- визуализирована CPC с разбивкой по полу пользователей;
- в исходный датафрейм добавлена колонка с CR в покупку.
### В работе использовалась:  
- модули Python: pandas, numpy, seaborn, scipy.stats, requests, urlencode.

## games.ipynb  
### Цель проекта:  
- выяснить на каких платформах произошло больше всего релизов;  
- выяснить игры каких издателей встречаются в датасете чаще всего;  
- найти регион с наибольшим медианным значением объема продаж игр Nintendo;  
- визуализировать динамику изменения объема мировых продаж по годам для игр Nintendo следующих жанров: Fighting, Simulation, Platform, Racing, Sports.
### Результат:  
- найдены наиболее популярные платформы: 'DS', 'PS2', 'PS3', 'Wii', 'X360', 'PSP', 'PS';  
- найдены наиболее популярные издатели: 'Electronic Arts', 'Activision', 'Namco Bandai Games', 'Ubisoft', 'Konami Digital Entertainment';  
- рассчитаны меры центральной тенденции объёма продаж игр Nintendo для каждого региона;  
- выявлено, что по наибольшим средним и медианным значением объема продаж игр Nintendo лидирует North America;  
- установлено, что медианное значение продаж игр жанра Fighting выше, чем у игр Simulation;  

### В работе использовались:  
- pandas;  
- numpy;   
- seaborn; 
- requests;  
- urlencode.  

## linear_regression.ipynb  
### Цель проекта:  
- предсказать стоимость автомобилей;  
- понять, от каких факторов зависит ценообразование на автомобили.
### Результат:  
- построена модель линейной регрессии для предсказания стоимости автомобилей; 
- выявлено, что среди предикторов 10 из 27 оказались не значимыми;  
### В работе использовалась:  
- pandas;  
- statsmodels.formula.api;  
- statsmodels.api.


## london_bicycle_rental.ipynb  
### Цель проекта:  
- объяснить аномалии на графике динамики числа аренд велосипедов.  
### Результат:  
- выявлено, что причина аномалий - ошибка в данных.
### В работе использовалась:  
- скользящее среднее;  
- seaborn;  
- pandas;  
- numpy;  
- requests;  
- urlencode.  

